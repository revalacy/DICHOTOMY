exports.run = (client, message, args) => {

  var firstmsg = ('```DICHOTOMY COMMANDS```\n\n*For all commands, use the following variables as indicated by the command information:*\n\n`Name`: The first name or nickname of the character taking the action itself. Required for all commands outside of the General section. Must match the name on the character\'s sheet.\n`X`: The skill or ability relevant to the roll or action.\n`Target`: The name of the character, object, or location you are targeting for your action. ');
  var general = ('```General Commands```\n**Dice:** `/dice` Rolls a 1d10. Does not evaluate success.\n**Random:** `/random` Rolls a 1d1000. Does not evaluate success.\n**Cointoss:** `/cointoss` Flips a coin between heads or tails.\n**Help:** `/help` Sends a list of active Dichotomy commands.');
  var plot = ('```Plot Commands```\n**Disobey:** `/disobey Name [Attempted action]`  Uses your active stats to attempt to push past the chaos caused by Madness when acting against Mother or Father. **Requires brackets around the attempted action.**\n**Social:** Under construction.\n**Willpower:** `/willpower Name`  Reverses previously-failed roll relating to mental stats. Spends 1 point of Willpower.\n**Madness:** `/madness Name subcommand` Contains the full array of Madness commands. The subcommand indicates the Madness action you intend to take.\n\n*Madness Subcommands:*\n**sanity:** `/madness Name sanity` Rolls the daily Sanity check based on your existing Madness points and stage.\n**dose:** `/madness Name dose` Ingests a dose of Madness tonic and adds +3 points to total Madness.\n**passive:** `/madness Name passive` Passively accepts +1 point of Madness for the day.\n**willpower:** `/madness Name willpower` Reduces total Madness points by 1. Be careful, Willpower only regenerates 1 point per day!\n**accept:** `/madness Name accept` Accepts Madness fully into your soul. Grants some bonuses to certain actions.\n**reject:** `/madness Name reject` Rejects Madness and its promises. This **does not remove or cure your Madness**. Grants some bonuses to certain actions.\n**exposure:** `/madness Name exposure` Rolls exposure based on the items around you that generate Madness.');
  var object = ('```Objects/Locations Commands```\n**Move:** `/move Name Location` Moves the indicated character to the target location.\n**Send:** `/send Name Location object` Sends the object in question to the location indicated.\n**Take:** `/take Name object` Takes the indicated object and adds it to the character\'s inventory. Large objects must be sent to a location instead.\n**Use:** `/use Name object` Uses the indicated object, triggers a variety of effects based on the object.\n**Investigate:** `/investigate Name Target` Review the clues attached to the specified target. Investigations are cumulative and contribute to an overall understanding of the object or location. Character investigations not yet supported. Non-event investigations have a 20 minute cooldown timer and must be done in DM with Dichotomy.\n**Damage:** `/damage Name Target` Causes damage to the named object or location.\n**Wear:** `/wear Name object` Adds the named object as attire, activates any effects generated by wearing an object.\n**Sethome:** `/sethome Name Location` Sets the named location as the individual\'s home. Checks location for a lock and the required item in the character\'s inventory if a lock exists.');
  var event = ('```Event/Action Commands```\n**Register:** `/register Name Event`Registers the named character for the event indicated. To remove someone from an event, use the command `/register Name Event remove`.\n**Attack:** `/attack Name stat Target1 Target2 Target3...` Launches individual attacks against the targets listed. An initial attack costs 5 action points, with one point spent for each additional target.\n**Defense:** `/defense Name` Rolls defense against all pending attacks and returns the number of failed rolls. Failing a defense exhausts all remaining action points.\n**Cover:** `/cover Name Target` Covers the target after a failed defense roll. Failing a Cover roll saps all remaining action points. Multiple cover actions can be taken sequentially as long as a cover has not been failed.\n**Heal:** `heal Name Target1 Target2 Target3...`  Heals the targets\' HP for a scaling value based on total roll. An initial heal costs 5 action points, with one point spent for each additional target.\n**Buff:** `/buff Name stat Target1 Target2 Target3...` Buffs the indicated stat for each named target. Stats to buff are: Strength, Dexterity, Perception, Attack, Defense, Heal, Damage, and Cover. An initial buff costs 5 action points, with one point spent for each additional target.\n**Charge:** `/charge Name Action` Rolls to add a bonus to the indicated action. Charge uses up all action points for a round in exchange for a significant boost to the named action. Actions that can be charged are: Attack, Heal, Buff.\n**Purify:** Under construction.\n**Investigate:** `/investigate Name Target` Review the clues attached to the specified target. Investigations are cumulative and contribute to an overall understanding of the object or location. Character investigations not yet supported. Each investigation costs 3 action points.');

  var msgs = [firstmsg, general, plot, object, event];
  
async function messagehandler (a){
var msgarray = a;
var timeoutstack = []
function doSetTimeout(i) {
setTimeout(function() { 
  msgarray[i] = msgarray[i].replace('[','').replace(']]',']**').replace('<>','');
  var n = msgarray[i].indexOf('|');
  console.log('n = ' + n);
  if (n != -1) {var [replacemsg, url] = msgarray[i].split('|'); console.log(url); msgarray[i] = replacemsg; console.log(msgarray[i] + ';' + url); message.author.send(msgarray[i], {files: [url]});};
  if (n === -1) message.author.send(msgarray[i]);
}, timeoutstack[i]);
}
for (var i = 0; i < msgarray.length; i++){
 timeoutstack[i] = 500 * i;
 doSetTimeout(i);
}}
  
messagehandler(msgs);
     }